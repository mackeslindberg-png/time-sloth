<!doctype html>
<html lang="sv">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>time/sloth PRO</title>

<style>
/* --- STYLES (oförändrade från din version) --- */
:root{
  --scale:1.15;
  --bg:#1b1b1b;
  --fg:#fff;
  --card:rgba(0,0,0,.18);
  --btn:rgba(255,255,255,.14);
  --btn2:rgba(255,255,255,.22);
  --outline:rgba(255,255,255,.22);
  --stageFg:#fff;
  --stageBadgeBg:rgba(0,0,0,.22);
  --stageBadgeBorder:rgba(0,0,0,.18);
  --laneBg:rgba(0,0,0,.18);
  --trackShadow:rgba(0,0,0,.25);
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;font-size:calc(16px * var(--scale))}
body{background:var(--bg);color:var(--fg);overflow:hidden;-webkit-tap-highlight-color:transparent;user-select:none}
.wrap{height:100%;padding:14px;padding-top:calc(14px + env(safe-area-inset-top));padding-bottom:calc(14px + env(safe-area-inset-bottom));display:flex;flex-direction:column;gap:12px}
.topbar{display:flex;gap:10px;align-items:center;justify-content:space-between}
.title{display:flex;align-items:center;gap:10px;font-weight:900;font-size:calc(16px * var(--scale));opacity:.95}
.logoTop{height:26px;width:26px;opacity:.25}
.panel{background:var(--card);border:1px solid var(--outline);border-radius:16px;padding:12px}
.row{display:flex;gap:10px;flex-wrap:wrap;justify-content:space-between;align-items:center}
.small{font-size:calc(12px * var(--scale));opacity:.82;font-weight:800}
.toast{margin-top:6px;font-size:calc(12px * var(--scale));font-weight:800}
.grid{display:grid;gap:10px}
.grid.cols2{grid-template-columns:1fr 1fr}
.chip{display:flex;align-items:center;justify-content:space-between;gap:8px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:12px;min-height:52px}
.chip label{display:flex;align-items:center;gap:10px;width:100%;cursor:pointer;font-weight:900}
.dot{width:14px;height:14px;border-radius:50%;border:1px solid rgba(0,0,0,.25)}
button{font:inherit;border:1px solid rgba(255,255,255,.18);background:var(--btn);color:var(--fg);border-radius:16px;padding:14px;font-weight:900;cursor:pointer}
button.primary{background:var(--btn2)}
button.danger{background:rgba(255,60,60,.22)}
button:disabled{opacity:.45;cursor:not-allowed}
.select{width:100%;border-radius:12px;border:1px solid rgba(255,255,255,.18);background:rgba(0,0,0,.18);color:var(--fg);padding:12px;font-weight:900}

/* stage */
.stage{flex:1;display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:22px;background:rgba(0,0,0,.15);position:relative;text-align:center}
.mode{font-size:clamp(34px,7vw,56px);font-weight:900}
.time{font-size:clamp(56px,11vw,92px);font-weight:900}
.next{font-style:italic;font-weight:900}
.badge{position:absolute;top:10px;right:10px;padding:8px 10px;border-radius:999px;font-weight:900}

/* drag */
.chip[draggable]{cursor:grab}
.chip.dragging{opacity:.5}
</style>
</head>

<body>
<div class="wrap">

<div class="topbar">
  <div class="title">
    <img src="loggaml.png" class="logoTop">
    <span>time/sloth PRO</span>
  </div>
</div>

<!-- MODES -->
<div class="panel">
  <div class="small"><b>Modes (drag to reorder)</b></div>
  <div class="grid cols2" id="modeChecks"></div>
</div>

<!-- MODE SETTINGS -->
<div class="panel">
  <div class="small"><b>Mode settings</b></div>
  <div class="grid" id="modeSettings"></div>
</div>

<!-- STAGE -->
<div class="stage" id="stage">
  <div class="badge" id="badge">IDLE</div>
  <div class="mode" id="mode">Select modes</div>
  <div class="time" id="time">--:--</div>
  <div class="next" id="next">NEXT UP: --</div>
</div>

</div>

<script>
/* ---------------- CORE ---------------- */
const el=id=>document.getElementById(id)
const MODE_KEYS=["FWD","Touring","1/12","Mod","GT","Kidz"]

const DEFAULT_MODE={
  FWD:{label:"FWD",voice:"Front wheel drive",weight:1,c1:"#1e5aa8"},
  Touring:{label:"Touring",voice:"Touring",weight:1,c1:"#f08a1a"},
  "1/12":{label:"1/12",voice:"One twelve",weight:1,c1:"#6a1b9a"},
  Mod:{label:"Mod",voice:"Modified",weight:1,c1:"#c62828"},
  GT:{label:"GT",voice:"Grand Touring",weight:1,c1:"#2e7d32"},
  Kidz:{label:"Kidz",voice:"Kids",weight:1,c1:"#ffffff"}
}

const profile={
  order:[...MODE_KEYS],
  enabled:{FWD:true,Touring:true,"1/12":true,Mod:true,GT:true,Kidz:true},
  modes:JSON.parse(JSON.stringify(DEFAULT_MODE))
}

/* ---------------- HELPERS ---------------- */
function labelFor(k){return profile.modes[k]?.label||k}

function updateModeChip(k){
  const cb=el("cb_"+k)
  if(!cb)return
  const chip=cb.closest(".chip")
  chip.querySelector(".dot").style.background=profile.modes[k].c1
  chip.querySelector("b").textContent=labelFor(k)
}

function updateSummary(block,k){
  block.querySelector("summary").textContent=labelFor(k)+" settings"
}

/* ---------------- UI BUILD ---------------- */
function buildModeChecks(){
  const c=el("modeChecks");c.innerHTML=""
  profile.order.forEach(k=>{
    const d=document.createElement("div")
    d.className="chip"
    d.draggable=true
    d.dataset.key=k
    d.innerHTML=`
      <label>
        <input type="checkbox" id="cb_${k}" ${profile.enabled[k]?"checked":""}>
        <span class="dot" style="background:${profile.modes[k].c1}"></span>
        <span><b>${labelFor(k)}</b></span>
      </label>`
    c.appendChild(d)

    d.addEventListener("dragstart",e=>{
      d.classList.add("dragging")
      e.dataTransfer.setData("text/plain",k)
    })
    d.addEventListener("dragend",()=>d.classList.remove("dragging"))
    d.addEventListener("dragover",e=>e.preventDefault())
    d.addEventListener("drop",e=>{
      e.preventDefault()
      const from=e.dataTransfer.getData("text/plain")
      if(from===k)return
      const a=profile.order
      a.splice(a.indexOf(from),1)
      a.splice(a.indexOf(k),0,from)
      buildModeChecks()
      buildModeSettings()
    })
  })
}

function buildModeSettings(){
  const c=el("modeSettings");c.innerHTML=""
  profile.order.forEach(k=>{
    const m=profile.modes[k]
    const d=document.createElement("details")
    d.innerHTML=`
      <summary>${labelFor(k)} settings</summary>
      <div>
        <label>Label on screen</label>
        <input type="text" value="${m.label}">
        <label>Voice</label>
        <input type="text" value="${m.voice}">
      </div>`
    const inputs=d.querySelectorAll("input")
    inputs[0].oninput=e=>{
      m.label=e.target.value||k
      updateModeChip(k)
      updateSummary(d,k)
      el("mode").textContent=labelFor(k)
    }
    inputs[1].oninput=e=>m.voice=e.target.value||m.label
    c.appendChild(d)
  })
}

/* ---------------- INIT ---------------- */
buildModeChecks()
buildModeSettings()
</script>
</body>
</html>
