<!doctype html>
<html lang="sv">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>time/sloth</title>

<style>
body{
  margin:0;
  font-family: system-ui, sans-serif;
  background:#1b1b1b;
  color:#fff;
  overflow:hidden;
}

.stage{
  height:100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  position:relative;
}

/* TEXT */
.mode{ font-size:48px; font-weight:900; }
.time{ font-size:72px; font-weight:900; }

/* TRACK */
.track{
  position:absolute;
  left:20px;
  right:20px;
  bottom:30px;
  display:flex;
  align-items:center;
  gap:12px;
}

.flag svg{
  color:white;
  opacity:.95;
}

.lane{
  flex:1;
  height:8px;
  background:rgba(255,255,255,.18);
  border-radius:999px;
  position:relative;
}

/* CAR */
.car{
  position:absolute;
  top:50%;
  left:0%;
  transform:translate(-50%,-50%);
  color:white;
  z-index:2;
  will-change:left, transform;
  filter:
    drop-shadow(0 2px 0 rgba(0,0,0,.3))
    drop-shadow(0 0 10px rgba(255,255,255,.2));
}

/* Glow when running */
.car.running{
  filter:
    drop-shadow(0 2px 0 rgba(0,0,0,.3))
    drop-shadow(0 0 18px rgba(255,255,255,.35))
    drop-shadow(0 0 32px rgba(255,255,255,.2));
}

/* Wobble animation */
.car.running svg{
  transform-origin:50% 70%;
  animation:wobble 260ms ease-in-out infinite;
}

@keyframes wobble{
  0%{ transform:rotate(-3deg); }
  50%{ transform:rotate(3deg); }
  100%{ transform:rotate(-3deg); }
}

/* Bounce on start */
.car.bounce{
  animation:bounce 500ms ease-out;
}

@keyframes bounce{
  0%{ transform:translate(-50%,-50%) scale(1); }
  40%{ transform:translate(-50%,-70%) scale(1.06); }
  70%{ transform:translate(-50%,-45%) scale(.98); }
  100%{ transform:translate(-50%,-50%) scale(1); }
}

/* Smoke */
.smoke{
  position:absolute;
  left:-6px;
  top:50%;
  transform:translate(-100%,-50%);
  width:50px;
  height:28px;
  opacity:0;
}

.car.running .smoke{ opacity:1; }

.puff{
  position:absolute;
  right:0;
  top:50%;
  width:10px;
  height:10px;
  border-radius:999px;
  background:rgba(255,255,255,.55);
  transform:translateY(-50%);
  animation:puff 520ms ease-out infinite;
}

.puff.p2{ animation-delay:160ms; width:8px; height:8px; }
.puff.p3{ animation-delay:320ms; width:12px; height:12px; }

@keyframes puff{
  0%{ transform:translate(0,-50%) scale(.7); opacity:0; }
  20%{ opacity:.7; }
  100%{ transform:translate(-40px,-50%) scale(1.6); opacity:0; }
}

/* Button */
button{
  margin-top:30px;
  padding:12px 22px;
  font-size:18px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.2);
  background:rgba(255,255,255,.15);
  color:#fff;
  font-weight:800;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="stage">

<div class="mode">RUN</div>
<div class="time" id="time">00:00</div>

<div class="track">

<!-- START -->
<div class="flag">
<svg viewBox="0 0 24 24" width="22">
<path fill="currentColor" d="M6 2h2v20H6z"/>
<path fill="currentColor" d="M8 3h10l-2 3 2 3H8z"/>
</svg>
</div>

<div class="lane">

<div class="car" id="car">

<div class="smoke">
<div class="puff"></div>
<div class="puff p2"></div>
<div class="puff p3"></div>
</div>

<svg viewBox="0 0 64 32" width="28">
<path fill="currentColor"
d="M10 22h44c3 0 5-2 5-5v-5c0-2-1-3-3-3h-7l-6-6H21l-6 6H8c-2 0-3 1-3 3v5c0 3 2 5 5 5z"/>
<circle fill="currentColor" cx="20" cy="24" r="4"/>
<circle fill="currentColor" cx="46" cy="24" r="4"/>
</svg>

</div>
</div>

<!-- FINISH -->
<div class="flag">
<svg viewBox="0 0 24 24" width="22">
<path fill="currentColor" d="M6 2h2v20H6z"/>
<path fill="currentColor" d="M8 4h12v10H8z"/>
</svg>
</div>

</div>

<button onclick="startHeat()">Start heat</button>

</div>

<script>
const car = document.getElementById("car");
const timeEl = document.getElementById("time");

let durationMs = 15000;
let startTime = 0;
let endTime = 0;
let timer = null;

function fmt(ms){
const total = Math.max(0, Math.ceil(ms/1000));
const s = total % 60;
const m = Math.floor(total/60);
return String(m).padStart(2,"0")+":"+String(s).padStart(2,"0");
}

function updateCar(now){
const elapsed = Math.max(0, Math.min(durationMs, now-startTime));
const pct = (elapsed/durationMs)*100;
car.style.left = pct+"%";
}

function tick(){
const now = Date.now();
const remaining = endTime-now;
timeEl.textContent = fmt(remaining);
updateCar(now);

if(remaining<=0){
clearInterval(timer);
car.style.left="100%";
car.classList.remove("running");
}
}

function bounce(){
car.classList.remove("bounce");
void car.offsetWidth;
car.classList.add("bounce");
setTimeout(()=>car.classList.remove("bounce"),600);
}

function startHeat(){
startTime = Date.now();
endTime = startTime + durationMs;

car.style.left="0%";
car.classList.add("running");
bounce();

if(timer) clearInterval(timer);
timer = setInterval(tick,60);
tick();
}
</script>

</body>
</html>
